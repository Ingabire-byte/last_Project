(()=>{(async()=>{let e=(e=>{let t=document.cookie.split(";");for(let n=0;n<t.length;n++){let l=t[n].split("=");if(e==l[0].trim())return decodeURIComponent(l[1])}return null})("access_token");if(!e)return null;const t=await fetch("/ajax/user/me",{method:"GET",headers:{Authorization:`Bearer ${e}`}}),n=await t.json();return n.error?null:n})().then((e=>{if(e){buildUserInterface(e);const t=document.location.pathname.split("/").at(-1);"signin"!=t&&"signup"!=t||(window.location.href="/"),"upload"===t&&"blocked"===e.status&&(alert("You`re not authorized to view this page. You will be redirected to the home page."),window.location.href="/")}})),buildUserInterface=e=>{document.querySelector("#user-menu-options").remove();let n=document.querySelector("#user-menu"),l=`\n        <div class="mr-4">\n            <button id="btn-profile" class="flex flex-row items-center gap-2">\n                <span class="hidden md:block text-base pl-2 border-l-2 border-gray-4">\n                ${e.username}\n                </span>\n                <img src="${e.profile_picture}" onerror="this.src='/static/images/default_avatar.png'" \n                class="h-7 w-7 rounded-full"\n                >\n            </button>\n        </div>\n    `;document.getElementById("user-sidebar-username").innerHTML=e.username,document.getElementById("user-sidebar-id").innerHTML=e.id,n.innerHTML=l;const o=document.getElementById("user-sidebar-upload"),d=document.getElementById("upload-item");"blocked"===e.status&&(o.remove(),d&&d.remove());const r=document.getElementById("sidebar-profile-right");if(e.is_staff&&2===e.role){const e=t();r.appendChild(e)}document.getElementById("profile-sidebar-picture").src=e.profile_picture,buildInteraction()},buildInteraction=()=>{const e=document.getElementById("btn-profile"),t=document.getElementById("profile-sidebar"),n=document.getElementById("btn-close-profile-sidebar"),l=document.getElementById("opacity-sidebar-profile");e.addEventListener("click",(()=>{t.classList.replace("hidden","flex"),d()})),n.addEventListener("click",(()=>{o()})),l.addEventListener("click",(()=>{o()}));const o=()=>{t.classList.replace("flex","hidden"),d()},d=()=>{"hidden"==document.documentElement.style.overflow?document.documentElement.style.overflow="auto":document.documentElement.style.overflow="hidden"}},signOut=async()=>{e("access_token"),e("refresh_token"),window.location.href="/"};const e=e=>{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`},t=()=>{const e=document.createElement("ul");e.classList.add("flex","flex-col","justify-center","w-full","p-3","border-t-2","border-gray-2");const t=[{id:"on-review",title:"On Review",link:"/approval/on-review",active:document.location.pathname.includes("/approval/on-review"),color:"yellow"},{id:"active",title:"Active",link:"/approval/active",active:document.location.pathname.includes("/approval/active"),color:"green"},{id:"rejected",title:"Rejected",link:"/approval/rejected",active:document.location.pathname.includes("/approval/rejected"),color:"red"},{id:"users",title:"Users",link:"/approval/users",active:document.location.pathname.includes("/approval/users"),color:null}],n=document.createElement("img");n.src=`${STATIC_URL}assets/icons/approval.svg`,n.classList.add("hidden","lg:block","h-7","w-7");const l=document.createElement("span");l.classList.add("hidden","lg:block","text-lg","font-semibold","text-gray-font","px-5","py-4","lg:p-3.5","lg:rounded-lg"),l.innerText="Approval";const o=document.createElement("div");return o.classList.add("flex","flex-row","items-center","w-full","mx-5"),o.appendChild(n),o.appendChild(l),e.appendChild(o),t.forEach((t=>{const{id:n,title:l,link:o,active:d,color:r}=t,i=document.createElement("li");i.setAttribute("id",`${n}-item`),i.classList.add("p-3.5","rounded-lg","hover:bg-gray-2","ml-2"),d&&i.classList.add("bg-blue-50","border","border-transparent","text-blue-txt");const a=document.createElement("a");a.href=o;const c=document.createElement("div");if(c.classList.add("flex","flex-row","justify-start","items-center"),r){const e=document.createElement("span");e.classList.add("h-3","w-3","rounded-full","ml-1",`bg-${r}-500`),c.appendChild(e)}else{const e=document.createElement("img");e.src=`${STATIC_URL}assets/icons/${n}.svg`,e.classList.add("h-5","w-5"),c.appendChild(e)}const s=document.createElement("span");s.classList.add("block","ml-4"),s.innerHTML=l,c.appendChild(s),a.appendChild(c),i.appendChild(a),e.appendChild(i)})),e}})();